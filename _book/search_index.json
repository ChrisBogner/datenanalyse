[
["aufgabensammlung.html", "Kapitel 9 Aufgabensammlung 9.1 Erste Schritte 9.2 Daten in R 9.3 Daten visualisieren, Teil I: Fokus auf R 9.4 Reproduzierbare Berichte mit R Markdown 9.5 Eigene Funktionen schreiben 9.6 Tidyverse 9.7 Daten visualisieren, Teil II: Fokus auf Daten 9.8 Tidy data", " Kapitel 9 Aufgabensammlung 9.1 Erste Schritte 9.1.1 Ars Haushaltsbuch Der angehende Datenanalyst Ar Stat möchte dem Rat seiner Mutter folgen und ein Haushaltsbuch anlegen. Als erstes möchte er sich einen Überblick über seine Ausgaben in der Uni-Mensa verschaffen und erstellt die folgende Tabelle: Tabelle 9.1: Ars Mensaausgaben Wochentag Ausgaben Montag 2,57 Dienstag 2,90 Mittwoch 2,73 Donnerstag 3,23 Freitag 3,90 Wie viel hat Ar insgesamt in der Woche ausgegeben? Wie viel hat er im Schnitt pro Tag ausgegeben? Wie stark schwanken seine Ausgaben? Leider hat Ar sich beim übertragen der Daten vertippt. Er hat am Dienstag seine Freundin zum Essen eingeladen und 7,95 € statt 2,90 € ausgegeben. Korrigieren Sie Ars Fehler. Wie verändern sich die Ergebnisse aus den Teilaufgaben 1 bis 3 Warum? 9.2 Daten in R 9.2.1 Bestandesaufnahme im Wald Ar Stat arbeitet als HiWi in der AG Ökosystemforschung und soll im Nationalpark Eifel eine Bestandsaufnahme durchführen (d.h. Baumhöhen und -durchmesser vermessen). Er notiert den BHD (Brusthöhendurchmesser) und die Art der Bäume. Lesen Sie den Datensatz BHD.txt ein und ordnen Sie ihn der Variable BHD zu. Erstellen Sie einen Vektor a mit Baumnummern. Von welcher Art sind die Elemente des Vektors a? Fügen Sie die Datensätze BHD und a zu einem data.frame zusammen und benennen Sie die Spalten sinnvoll. Löschen Sie den Vektor a. Lesen Sie den Datensatz Art.txt ein und ordnen Sie ihn der Variablen art zu. Fügen Sie die Art in den data.frame ein. Erstellen Sie eine Tabelle mit der Anzahl der jeweiligen Arten. Nutzen Sie die Funktion table. Speichern Sie die Tabelle mit write.table. 9.3 Daten visualisieren, Teil I: Fokus auf R 9.3.1 Wahlbeteiligung bei der Bundestagswahl 2017 Bauen Sie die Grafiken aus der Einführung nach (Abbildung 9.1). Abbildung 9.1: Wahlbeteiligung bei den Bundestagswahlen. Quelle: Der Bundeswahlleiter. Lesen Sie den Datensatz Wahlbeteiligung.csv in R ein und ordnen Sie ihn dem Objekt bet zu. Der Datensatz hat einen header und haben einen Strichpunkt als Spaltentrenner. Sehen Sie sich die Struktur und die ersten und letzten 6 Zeilen des Datensatzes an. Stellen Sie die Wahlbeteiligung als Funktion der Zeit in einem Streudiagramm dar. Wählen Sie die passende Darstellungsform type. Beschriften Sie die Grafik. Speichern Sie die Grafik als pdf ab. 9.3.2 Zweitstimme bei der Bundestagswahl 2017 Bauen Sie die Grafiken aus der Einführung nach (Abbildung 9.2). Abbildung 9.2: Zweitstimme bei der Bundestagswahl 2017. Quelle: Der Bundeswahlleiter. Lesen Sie den Datensatz Zweitstimme.csv in R ein und ordnen Sie ihn dem Objekt zweit zu. Der Datensatz hat einen header und haben einen Strichpunkt als Spaltentrenner. Sehen Sie sich die Struktur und die ersten und letzten 6 Zeilen des Datensatzes an. Stellen Sie die die Zweitstimmen pro Partei in einem Säulendiagramm dar. Sortieren Sie die Zweitstimmen in absteigender Reihenfolge. Beschriften Sie die Grafik. Speichern Sie die Grafik als pdf ab. 9.3.3 Ergebnisse der Bundestagswahl in einer Grafik Stellen Sie beide Grafiken nebeneinander dar wie in Abbildung (9.3) gezeigt. Abbildung 9.3: Ergebnisse der Bundestagswahl 2017. Quelle: Der Bundeswahlleiter. 9.3.4 Einen zu großen weißen Rand vermeiden Bei Berichten haben Abbildungen meistens keine Überschrift, da alles in der Bildunterschrift erklärt wird. Wenn man die Überschrift beim plotten weglässt, die Standardeinstellungen für die Ränder aber beibehält, entsteht ein zu großer weißer Rand um die Grafik. Diesen wollen wir nun abschalten. Kopieren Sie den Code zum Plotten der Temperaturen aus dem Kapitel 5. Stellen Sie oben und rechts einen Rand von 0.1 Zeilen ein. Speichern Sie die Grafik als pdf ab. 9.3.5 Spielen mit der Funktion par Setzen Sie die Übung 9.3.4 fort. Denken Sie an den richtigen Aufruf mit der Zuweisung von op &lt;- par( ... )! Probieren Sie die Größeneinstellung cex = 2 in plot aus. Testen Sie unterschiedliche Werte. Probieren Sie die Einstellungen cex.axis, cex.lab und cex.main in par aus. Probieren Sie die Einstellung col in plot aus. Probieren Sie die Einstellungen col.axis, col.lab und col.main aus. Probieren Sie die Schrifteinstellungen aus. Dazu stellen Sie den Parameter family in par auf “serif”, “sans” oder “mono”. Probieren Sie die Parameter font.lab = 2 und font.axis = 2 direkt in plot aus. Zahlen 1 bis 5 stehen jeweils für normal, fett, kursiv, fett-kursiv und symbolisch. 9.4 Reproduzierbare Berichte mit R Markdown 9.4.1 Erster eigener Bericht Erstellen Sie ein R Notebook aus den Notizen der ersten 3 R-Sessions. 9.5 Eigene Funktionen schreiben 9.5.1 R-Hausaufgaben An dem Kurs “Einführung in R” nehmen 49 Studierende teil. Der Leistungsnachweis besteht aus Hausaufgaben, die insgesamt mit 100 Punkten bewertet werden. Ab 50 Punkten gilt der Kurs als bestanden. Lesen Sie den Datensatz R-HAs.txt, der die Endpunkte enthält, ein. Ermitteln Sie, wie viele Teilnehmer bestanden und wie viele nicht bestanden haben. 9.5.2 Fledermäuse, die Zweite Wir beschäftigen uns erneut mit den Fledermäusen. Lesen Sie den korrigierten(!) Datensatz Fledermaus_cor.txt ein. Schreiben Sie eine Funktion, die den Entwicklungsstand der Tiere klassifiziert. Nutzen Sie dazu die ad hoc Regel: Individuum &lt; 5 cm ist ein Jungtier, sonst erwachsen. Erstellen Sie eine ordinal-skalierte Variable alter mit dem Entwicklungsstand der Tiere. Wie viele Erwachsene und wie viele Jungtiere wurden vermessen? 9.6 Tidyverse 9.6.1 Fledermaus, die Dritte Wiederholen Sie die Aufgabe 9.5.2 mit tidyverse Berechnen Sie die Mittelwerte der Größe für weibliche und männliche Individuen. Berechnen Sie die Mittelwerte der Größe für die Kategorien weiblich, männlich, Jungtier und erwachsen getrennt. 9.6.2 Unfaire Klausur? Ar belegt im 4. Semester die Veranstaltung “Spaß mit R”. Bei der Klausur gibt es 2 Aufgabengruppen mit jeweils 60 Punkten. Aufgabengruppe 1 wird an Studierende auf ungeraden Sitzplätzen und Aufgabengruppe 2 an Studierende auf geraden Sitzplätzen ausgegeben. Lesen Sie den Datensatz Klausurpunkte.txt ein. Überprüfen Sie Ars Vermutung, dass die Aufgabengruppe 1 im Schnitt leichter war als Aufgabengruppe 2 (d.h. in der Gruppe 1 im Schnitt mehr Punkte erzielt wurden). Berechnen Sie erst die Mittelwerte pro Gruppe. Testen Sie dann mit einem Permutationstest, ob die Mittelwerte signifikant verschieden sind. Adaptieren Sie den Code aus dem Tutorial Hypothesentests_1.Rmd. 9.7 Daten visualisieren, Teil II: Fokus auf Daten 9.7.1 Zeitreihen aus der Langen Bramke (Harz) Im Harz wurden über eine längere Zeit Niederschlag, Abfluss und Temperatur gemessen. Laden Sie den Datensatz Data.dat. Stellen Sie die Temperatur in einem Streudiagramm dar. Welche Darstellungsart (Argument type in plot) erscheint Ihnen am sinnvollsten? Beschriften Sie die Graphik und fügen Sie einen Titel hinzu. Speichern Sie die Graphik als pdf ab. Stellen Sie die Niederschläge in einem Diagramm dar. Wählen Sie einen geeigneten Darstellungstyp mit type (Tipp: geben Sie für die Hilfe ?plot in die Konsole ein). 9.7.2 Temperatur-Datensatz Die Datei Temperatur.csv aus Zuur, Ieno, and Meesters (2009) enthält Messungen von Temperatur, Salinität und Chlorophyl a an 31 Orten entlang der dänischen Küste. Die Daten stammen vom dänischen Institut RIKZ (Monitoringprogramm MWTL: Monitoring Waterstaatkundige Toestand des Lands). Die Messungen wurden zwischen 1990 und 2005 durchgeführt mit einer Häufigkeit von 0-4 mal pro Monat je nach Jahreszeit. Lesen Sie den Temperatur-Datensatz Temperatur.csv ein. Berechnen Sie die Anzahl der Messwerte, Monatsmittelwerte für alle Stationen, sowie die Standardabweichungen. Stellen Sie die Monatsmittel der Temperatur als Linien dar. Beschriften Sie die Grafik sinnvoll. Fügen Sie die Standardabweichungen als Band hinzu. Speichern Sie die Grafik als pdf ab. 9.7.3 Temperatur-Datensatz, revisited Berechnen Sie die Monatsmittelwerte und Standardabweichungen je Station. Tipp: group_by(Station, Month). Stellen Sie die Daten mit einem Fehlerband dar und speichern Sie sie ab. Stellen Sie die Daten als Punkte mit Fehlerbalken dar und speichern Sie sie ab. Zur Orientierung, das Ergebnis sollte so aussehen wie in Abbildung (9.4). Abbildung 9.4: Mittelwerte der Temperatur je Station (Zuur, Ieno, and Meesters 2009) 9.7.4 Artenvielfalt in Grasländern Sie erhalten Daten aus dem Grasland-Monitoring im Yellowstone Nationalpark und dem National Bison Range (USA). Das Ziel des Monitorings ist die Untersuchung möglicher Änderungen der Biodiversität und des Zusammenhang mit Umweltfaktoren. Biodiversität wurde durch die Anzahl unterschiedlicher Arten quantifiziert. Insgesamt haben die Forscher ca. 90 Arten in 8 Transekten kartiert. Die Aufnahmen wurden alle 4 bis 10 Jahre wiederholt. Insgesamt liegen 58 Beobachtungen vor. Die Daten sind in der Datei Vegetation2.xls gespeichert. Laden Sie den Datensatz in R und sehen Sie sich das Ergebnis genau mit str, head und tail an. Diese Aufgabe dient dazu, das Einlesen von Excel-Dateien mit tidyverse zu erarbeiten. Tipp: nutzen Sie die Funktion read_xls() in der Bibliothek readxl. Lesen Sie genau in der Hilfe nach, wie Sie ein bestimmtes Tabellenblatt einlesen können. Kurze explorative Analyse: Berechnen Sie die Anzahl der Messungen, den Mittelwert und die Standardabweichung der Artenzahl (Variable R) pro Transekt. Plotten Sie die Artenzahl gegen die Variable BARESOIL (Anteil von unbewachsenem Boden). Färben Sie die Punkte je nach Transekt unterschiedlich ein. Tipp: Transekt als as.factor() konvertieren. Fügen Sie eine glättende Linie ohne Konfidenzband hinzu, die alle Punkte unabhängig vom Transekt berücksichtigt (Abschnitt 5.2 in ggplot2 Buch). Beschriften Sie die Graphik (auch die Legende!) sinnvoll und speichern Sie sie als pdf ab. Stellen Sie die Artenzahl je Transekt als Zeitreihe dar. Die Symbole sollen sowohl Punkte als auch Linien sein. Skalieren Sie die Größe der Punkte je nach Anteil des unbewachsenen Bodens (Abschnitt 6.2 im ggplot2 Buch). Beschriften Sie die Grafik (auch die Legenden!) sinnvoll und speichern Sie sie als pdf ab. Setzen Sie nun beide Grafiken neben einander, platzieren Sie die Legenden (ja nach gewähltem Layout) sinnvoll und speichern Sie die Grafiken ab. 9.7.5 Tracerversuche Im Waldstein wurden Tracerversuche mit dem Farbstoff Brilliant Blue durchgeführt und die gefärbten Bodenprofile binärisiert (d.h. in ein schwarz-weiß Bild umgewandelt). Schwarze Pixels stellen gefärbten Boden und weiße ungefärbten dar. Aus diesen Binärbildern wurde anschließend eine Reihe von Kenngrößen berechnet. Lesen Sie die Datei Waldstein2005_ind.txt ein. Die Tiefe eines Profils ist 579 Pixel und es liegen 6 Profile untereinander in der Spalte d. Berechnen Sie die 5%, 50% und 95% Quantile des Färbeanteils (Index d) der 6 Profile. Stellen Sie den Median des Anteils der Färbung mit der Tiefe dar und fügen Sie die Quantile als transparente Fläche hinzu (Tipp: polygon). 9.8 Tidy data 9.8.1 Wasserentnahme mit Datenquelle Excel Wir beschäftigen uns mit dem Einlesen und bereinigen von Daten aus Exceldateien. Dazu nutzen wir das Beispiel aus einer der ersten Sitzungen zur Wasserentnahme in der EU. Sehen Sie sich die Strukture der Datei TEN000021586860138332.xlsx an und lesen Sie sie ein. Nutzen Sie dazu die Funktion read_xlsx() aus dem Paket readxl. Bereinigen Sie den Datensatz und konvertieren Sie ihn in tidy. Nutzen Sie dazu die Funktion pivot_longer(). Finden und korrigieren Sie den Fehlwert. Filtern Sie die Einträge für die EU heraus und behalten Sie nur die einzelnen Länder bei. Stellen Sie die Änderung der Wasserentnahme pro Land dar. 9.8.2 Wasserentnahme mit Datenquelle EUROSTAT direkt Wir können die Datenbank EUROSTAT direkt über ihr API (Application Programming Interface) ansprechen. Leider ist das herunter geladene Datenformat sehr umständlich. Um uns Programmierarbeit zu sparen, nutzen wir das Paket eurostat, das die Daten aus der Datenbank herunterlädt und gleich ordentlich formatiert. Installieren Sie das Paket eurostat und sehen Sie sich das Tutorial für das Paket an (https://ropengov.github.io/eurostat/articles/website/eurostat_tutorial.html) Durchsuchen Sie die Datenbank nach allen Datensätzen, die das Wort “water” enthalten und darin das Wort “abstraction”. Laden Sie den entsprechenden Datensatz herunter (env_wat_abs). Das Paket skimr bietet Zusammenfassungsfunktionen für Datensätze, die man auch in der Pipe benutzen kann. Installieren Sie das Paket und wenden Sie die Funktion skim() auf den heruntergeladenen Datensatz an. Welche Wasserquellen und Nutzer sind im Datensatz enthalten (https://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=env_wat_abs&amp;lang=en)? Stellen Sie die Wasserentnahme pro Einwohner dar (Gesamtentnahme aus allen Quellen: wat_proc == ‘ABST’ &amp; wat_src == ‘FRW’). Berechnen Sie die Gesamtmenge des entnommenen Wassers für alle Länder je Quelle (Fresh surface water und Fresh ground water). Stellen Sie diese Daten als Punktdiagramm, als Balkendiagramm und als Flächendiagramm dar. Was ist das Problem mit dem Flächendiagramm? "]
]
